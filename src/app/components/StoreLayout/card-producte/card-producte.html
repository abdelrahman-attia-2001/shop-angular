<a
  [routerLink]="['/product', product._id]"
  class="block h-full"
>
  <div
    class="group bg-white dark:bg-gray-900 rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 hover:shadow-xl transition-all duration-300 flex flex-col h-full cursor-pointer"
  >
    <!-- Product Image -->
    <div class="relative aspect-[4/5] overflow-hidden bg-gray-100 dark:bg-gray-800">
      <img
        [alt]="product.title"
        [src]="product.imageCover"
        class="object-cover transition-transform duration-500 group-hover:scale-110 w-full h-full"
      />

      <!-- Sale Badge -->
      <div
        *ngIf="product.priceAfterDiscount"
        class="absolute top-3 left-3 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full"
      >
        SALE
      </div>

      <!-- Wishlist Button -->
      <div
        class="absolute right-3 top-3 opacity-0 translate-x-4 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300"
      >
        <button
          (click)="onToggleWishlist($event)"
          class="p-2 rounded-full shadow-md transition-colors border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-600 dark:text-gray-400 hover:text-red-500 dark:hover:text-red-500"
        >
          <mat-icon [class.text-red-500]="product.inWishlist" [class.dark:!text-red-500]="product.inWishlist" class="!text-xl">
            {{ product.inWishlist ? 'favorite' : 'favorite_border' }}
          </mat-icon>
        </button>
      </div>
    </div>

    <!-- Product Info -->
    <div class="p-4 flex flex-col flex-grow">
      <!-- Category & Rating -->
      <div class="flex items-center justify-between mb-2">
        <span
          class="text-xs font-medium text-cyan-600 dark:text-cyan-400 uppercase tracking-wider"
        >
          {{ product.category.name }}
        </span>
        <div class="flex items-center gap-1">
          <mat-icon class="!text-sm text-yellow-400">star</mat-icon>
          <span class="text-sm font-medium text-gray-900 dark:text-white">
            {{ product.ratingsAverage }}
          </span>
        </div>
      </div>

      <!-- Product Title -->
      <h3
        class="font-semibold text-gray-900 dark:text-white line-clamp-2 hover:text-cyan-600 dark:hover:text-cyan-400 transition-colors mb-2"
      >
        {{ product.title }}
      </h3>

      <!-- Price & Cart Button -->
      <div class="mt-auto pt-4 flex items-center justify-between">
        <div class="flex flex-col">
          <span class="text-lg font-bold text-cyan-600 dark:text-cyan-400">
            ${{ product.priceAfterDiscount || product.price }}
          </span>
          <span
            *ngIf="product.priceAfterDiscount"
            class="text-sm text-gray-500 dark:text-gray-400 line-through"
          >
            ${{ product.price }}
          </span>
        </div>

        <!-- Add to Cart Button -->
        <button
          (click)="onAddToCart($event)"
          class="rounded-full w-10 h-10 p-0 flex items-center justify-center transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-orange-500 hover:bg-orange-600 text-white shadow-lg shadow-orange-500/20"
        >
          <mat-icon class="!text-xl">shopping_cart</mat-icon>
        </button>
      </div>
    </div>
  </div>
</a>